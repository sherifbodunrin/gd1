<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
body {
    background-color: black; /* Set background for the whole page */
    color: white; /* Default text color to white for visibility */
    font-family: Arial, sans-serif;
    text-align: center; /* Center the text */
}

canvas {
    border: 1px solid #d3d3d3;
    background-color: black; /* Set canvas background to black */
}

button {
    margin: 5px;
}

.story {
    margin: 20px;
    padding: 10px;
    border: 1px solid white; /* Optional: add border for visibility */
}
</style>
</head>
<body>
<h2>Story</h2>
<div class="story">
    <p>You are in the depths of outer space, trying to escape from relentless alien pursuers! Your spaceship is equipped with only basic maneuvering capabilities. As you fly through the cosmic void, you must dodge dangerous laser poles that the aliens have set up to hinder your escape.</p>
    <p>Keep your reflexes sharp and use the UP Arrow key to jump over the lasers. With each second that passes, your score increases, proving your skill in surviving the alien onslaught. Can you outsmart the aliens and survive the dangers of space? Every decision counts!</p>
    <p>Press SPACE to pause the game at any time, but bewareâ€”every moment spent in pause is a moment the aliens could be closing in!</p>
    <p>How long can you stay alive and escape the clutches of your extraterrestrial foes?</p>
</div>
<button id="startButton" onclick="startGame()">Start Game</button>
<button id="pauseButton" onclick="togglePause()">Pause</button>
<canvas id="gameCanvas" width="480" height="270"></canvas>
<div>
    <p>Use the UP Arrow to jump</p>
    <p>Press the SPACE key to pause/resume the game</p>
    <p>How long can you stay alive?</p>
</div>

<!-- Audio element -->
<audio id="backgroundMusic" loop>
    <source src="Music.mp3" type="audio/mp3">
    Your browser does not support the audio element.
</audio>

<script>
var myGamePiece;
var myObstacles = [];
var myScore;
var characterImage = new Image();
var poleImage = new Image();
var explosionImage = new Image(); // Explosion image
var isPaused = false;
var interval;
var gameOver = false;
var backgroundMusic = document.getElementById("backgroundMusic");

characterImage.src = 'https://clipart-library.com/images/8T68RMeac.png'; // Character image
poleImage.src = 'https://res.cloudinary.com/mirukusheku/image/upload/v1495140035/Red_laser-ConvertImage_votu8o.png'; // Pole image
explosionImage.src = 'https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExaWxidTFhb3k5aW9qdmIxN3BpNDQ4NzJ2OTB4YzZnaTRxcG45MTZjciZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/d4aVHC1HKnButuXC/giphy.gif'; // Explosion GIF

function startGame() {
    myGamePiece = new gameObject(30, 30, characterImage, 10, 120, "image");
    myScore = new gameObject("30px", "Consolas", "white", 280, 40, "text");
    myScore.text = "";
    myObstacles = []; // Reset obstacles
    gameOver = false; // Reset game over state
    myGameArea.start();
    backgroundMusic.play(); // Play background music
    window.addEventListener("keydown", controlGamePiece);
}

var myGameArea = {
    canvas: document.getElementById("gameCanvas"),
    start: function() {
        this.frameNo = 0;
        interval = setInterval(updateGameArea, 20);
    },
    clear: function() {
        var ctx = this.canvas.getContext("2d");
        ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    }
};

function gameObject(width, height, image, x, y, type) {
    this.type = type;
    this.width = width;
    this.height = height;
    this.x = x;
    this.y = y;
    this.image = image;
    this.gravity = 0.1;
    this.gravitySpeed = 0;
    this.text = "";

    this.update = function() {
        var ctx = myGameArea.canvas.getContext("2d");
        if (this.type === "text") {
            ctx.font = this.width + " " + this.height;
            ctx.fillStyle = "white"; // Text color
            ctx.fillText(this.text, this.x, this.y);
        } else {
            ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
        }
    };

    this.newPos = function() {
        this.gravitySpeed += this.gravity;
        this.y += this.gravitySpeed;
        this.hitBottom();
    };

    this.hitBottom = function() {
        var rockbottom = myGameArea.canvas.height - this.height;
        if (this.y > rockbottom) {
            this.y = rockbottom;
            this.gravitySpeed = 0;
        }
    };

    this.crashWith = function(otherobj) {
        var myleft = this.x;
        var myright = this.x + this.width;
        var mytop = this.y;
        var mybottom = this.y + this.height;
        var otherleft = otherobj.x;
        var otherright = otherobj.x + otherobj.width;
        var othertop = otherobj.y;
        var otherbottom = otherobj.y + otherobj.height;

        return !(mybottom < othertop || mytop > otherbottom || myright < otherleft || myleft > otherright);
    };
}

function updateGameArea() {
    if (isPaused || gameOver) return; // Don't update if paused or game over

    myGameArea.clear();
    myGameArea.frameNo += 1;

    if (myGameArea.frameNo == 1 || everyinterval(150)) {
        var x = myGameArea.canvas.width;
        var minHeight = 20;
        var maxHeight = 200;
        var height = Math.floor(Math.random() * (maxHeight - minHeight + 1) + minHeight);
        var minGap = 50;
        var maxGap = 100;
        var gap = Math.floor(Math.random() * (maxGap - minGap + 1) + minGap);
        myObstacles.push(new gameObject(10, height, poleImage, x, 0, "image"));
        myObstacles.push(new gameObject(10, myGameArea.canvas.height - height - gap, poleImage, x, height + gap, "image"));
    }

    for (var i = 0; i < myObstacles.length; i += 1) {
        myObstacles[i].x += -1;
        myObstacles[i].update();
    }

    for (var i = 0; i < myObstacles.length; i += 1) {
        if (myGamePiece.crashWith(myObstacles[i])) {
            displayExplosion();
            return;
        }
    }

    myScore.text = "SCORE: " + myGameArea.frameNo;
    myScore.update();
    myGamePiece.newPos();
    myGamePiece.update();
}

function everyinterval(n) {
    return (myGameArea.frameNo % n === 0);
}

function controlGamePiece(e) {
    if (e.key === "ArrowUp") {
        myGamePiece.gravitySpeed = -2; // Jump strength
    }
    if (e.key === " ") {
        togglePause(); // Use spacebar to toggle pause
    }
}

function togglePause() {
    isPaused = !isPaused;
    document.getElementById("pauseButton").innerText = isPaused ? "Continue" : "Pause";
    if (isPaused) {
        backgroundMusic.pause(); // Pause music if game is paused
    } else {
        backgroundMusic.play(); // Resume music if game continues
    }
}

function displayExplosion() {
    gameOver = true; // Set game over state
    var ctx = myGameArea.canvas.getContext("2d");
    
    // Draw the explosion GIF without clearing the canvas
    ctx.drawImage(explosionImage, myGamePiece.x - 15, myGamePiece.y - 15, 100, 100); // Adjust size and position

    // Wait for the explosion GIF to finish before showing the game over message
    setTimeout(() => {
        alert("Game Over! Your score: " + myGameArea.frameNo);
        clearInterval(interval);
        backgroundMusic.pause(); // Stop music on game over
    }, 3000); // Adjust the timeout duration as needed (3000 ms = 3 seconds)
}
</script>

</body>
</html>
